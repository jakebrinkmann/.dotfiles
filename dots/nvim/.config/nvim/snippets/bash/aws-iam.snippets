# aws.security.IAM (Identity and Access Management)
snippet aws-iam-list-roles
    aws iam list-roles | jq -c '.Roles[].Arn'

snippet aws-iam-create-user
    aws iam create-user --user-name MyCdkUser

snippet aws-iam-create-key
    aws iam create-access-key --user-name MyCdkUser

snippet aws-iam-delete-key
    aws iam delete-access-key --user-name MyCdkUser --access-key-id AKIAIOSFODNN7EXAMPLE

snippet aws-iam-list-policies
    aws iam list-policies \
        --scope Local --only-attached --policy-usage-filter PermissionsPolicy --query Policies[]

snippet aws-iam-get-policy
    aws iam get-policy-version --policy-arn <Arn> --version-id <DefaultVersionId>

# aws.security.STS (Security Token Service)
snippet aws-sts-get-id
    aws sts get-caller-identity --output json | jq '.Account' -r

snippet aws-sts-get-id-query
    aws sts get-caller-identity --query 'Arn' --output text

snippet aws-sts-assume
    aws sts assume-role --role-arn $ROLE --role-session-name $USER

snippet aws-sts-decode-msg
    aws sts decode-authorization-message \
        --encoded-message (encoded error message) --query DecodedMessage --output text | jq '.'
